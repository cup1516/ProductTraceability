<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.pt.ptdealerprod.mapper.ProdTypeMapper">
  <resultMap id="BaseResultMap" type="com.pt.ptdealerprod.entity.ProdType">
    <!--@mbg.generated-->
    <!--@Table dealer_type-->
    <id column="type_id" property="typeId" />
    <result column="company_id" property="companyId" />
    <result column="type_code" property="typeCode" />
    <result column="type_name" property="typeName" />
    <result column="status" property="status" />
    <result column="create_by" property="createBy" />
    <result column="create_time" property="createTime" />
    <result column="remark" property="remark" />
    <result column="del_flag" property="delFlag" />
  </resultMap>
  <sql id="selectProdType">
			select t.type_id,t.company_id,t.type_code,t.type_name,t.status,t.create_by,t.remark,t.create_time
			from dealer_type t
		</sql>

  <select id="getProdTypePage" resultMap="BaseResultMap">
    <include refid="selectProdType"/>
    <where>
      t.del_flag = '0' and t.company_id = #{companyId}
      <if test="query.typeCode != null and query.typeCode != ''">
        AND t.type_code like concat('%', #{query.typeCode}, '%')
      </if>
      <if test="query.typeName != null and query.typeName != ''">
        AND t.type_name like concat('%', #{query.typeName}, '%')
      </if>
      <if test="query.status != null and query.status != ''">
        AND t.status = #{query.status}
      </if>
    </where>
    ORDER BY t.create_time DESC
  </select>

  <select id="getProdTypeList" resultMap="BaseResultMap">
    select t.type_id, t.type_code,t.type_name
    from dealer_type t
    <where>
      t.del_flag = '0' and t.status = '0' and t.company_id = #{companyId}
    </where>
    ORDER BY t.type_code ASC
  </select>
  <select id="getProdTypeListByName" resultMap="BaseResultMap">
    select t.type_id, t.type_code,t.type_name
    from dealer_type t
    <where>
      t.del_flag = '0' and t.status = '0' and t.company_id = #{companyId}
      <if test="typeName != null and typeName != ''">
        AND t.type_name like concat('%', #{typeName}, '%')
      </if>
    </where>
    ORDER BY t.type_code ASC
  </select>
  <select id="selectTypeList" resultMap="BaseResultMap">
    <include refid="selectProdType"/>
    <where>
      company_id = #{companyId}
      <if test="type.typeCode != null and type.typeCode != ''">
        AND type_code like concat('%', #{type.typeCode}, '%')
      </if>
      <if test="type.status != null and type.status != ''">
        AND status = #{type.status}
      </if>
      <if test="type.typeName != null and type.typeName != ''">
        AND type_name like concat('%', #{type.typeName}, '%')
      </if>
    </where>
  </select>

  <select id="selectTypeAll" resultMap="BaseResultMap">
    <include refid="selectProdType"/>
    where  company_id = #{companyId}
  </select>

  <select id="selectTypeById"  resultMap="BaseResultMap">
    <include refid="selectProdType"/>
    where type_id = #{typeId} and company_id = #{companyId}
  </select>

  <select id="checkTypeNameUnique"  resultMap="BaseResultMap">
    <include refid="selectProdType"/>
    where type_name=#{typeName} and company_id = #{companyId}
  </select>

  <select id="checkTypeCodeUnique"  resultMap="BaseResultMap">
    <include refid="selectProdType"/>
    where type_code=#{typeCode} and company_id = #{companyId}
  </select>

  <update id="updateType" >
    update dealer_type
    <set>
      <if test="type.typeCode != null and type.typeCode != ''">type_code = #{type.typeCode},</if>
      <if test="type.typeName != null and type.typeName != ''">type_name = #{type.typeName},</if>
      <if test="type.status != null and type.status != ''">status = #{type.status},</if>
      <if test="type.remark != null">remark = #{type.remark},</if>
    </set>
    where type_id = #{type.typeId} and company_id = #{companyId}
  </update>

  <insert id="insertType"  keyProperty="typeId">
    insert into dealer_type(
    <if test="type.typeId != null and type.typeId != ''">type_id,</if>
    <if test="companyId != null and companyId != ''">company_id,</if>
    <if test="type.typeCode != null and type.typeCode != ''">type_code,</if>
    <if test="type.typeName != null and type.typeName != ''">type_name,</if>
    <if test="type.status != null and type.status != ''">status,</if>
    <if test="type.remark != null and type.remark != ''">remark,</if>
    <if test="type.createBy != null and type.createBy != ''">create_by,</if>
    create_time
    )values(
    <if test="type.typeId != null and type.typeId != ''">#{type.typeId},</if>
    <if test="companyId != null and companyId != ''">#{companyId},</if>
    <if test="type.typeCode != null and type.typeCode != ''">#{type.typeCode},</if>
    <if test="type.typeName != null and type.typeName != ''">#{type.typeName},</if>
    <if test="type.status != null and type.status != ''">#{type.status},</if>
    <if test="type.remark != null and type.remark != ''">#{type.remark},</if>
    <if test="type.createBy != null and type.createBy != ''">#{type.createBy},</if>
    sysdate()
    )
  </insert>

  <update id="deleteTypeByIds"  >
    update dealer_type set del_flag = '1' where company_id = #{companyId} and type_id in
    <foreach collection="typeIds" item="typeId" open="(" separator="," close=")">
      #{typeId,jdbcType=VARCHAR}
    </foreach>
  </update>

  <update id="deleteTypeById" >
    update dealer_type set del_flag = '1' where type_id = #{typeId} and company_id = #{companyId}
  </update>
</mapper>
